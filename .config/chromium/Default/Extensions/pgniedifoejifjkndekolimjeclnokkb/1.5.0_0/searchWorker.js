(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
var filterMode,filteredEmotesCount,filteredEmotes={twitch:[],bttv:[],ffz:[],seventv:[]};function initialize(e,t){filterMode=e,filteredEmotesCount=t.length;for(var i=0;i<t.length;++i)"Twitch.tv"===t[i].set?filteredEmotes.twitch.push(t[i]):"BetterTTV"===t[i].set?filteredEmotes.bttv.push(t[i]):"FrankerFaceZ"===t[i].set?filteredEmotes.ffz.push(t[i]):"7TV"===t[i].set&&filteredEmotes.seventv.push(t[i])}function isEmoteAllowed(e,t){var i=!0;filteredEmotesCount>0&&(i=null===getMatchingFilterRule(e,t),"Whitelist"===filterMode&&(i=!i));return i}function getMatchingFilterRule(e,t){for(var i=getMatchingFilterSet(e),l=null,r=0;r<i.length;++r){var n=i[r];if(n.value===t){l=n;break}}return l}function getMatchingFilterSet(e){var t=filteredEmotes.twitch;return 0===e.indexOf("bttv")?t=filteredEmotes.bttv:0===e.indexOf("ffz")?t=filteredEmotes.ffz:0===e.indexOf("seventv")&&(t=filteredEmotes.seventv),t}module.exports={initialize:initialize,isEmoteAllowed:isEmoteAllowed};

},{}],2:[function(require,module,exports){
var emoteFilter=require("./emoteFilter");const STRING_SEPARATOR=/([\w]|[:;)(\\\/<>73#\|\]])+/g,TWITCH_TV_MATCHING_REGEX=/\btwitch\.tv/i;var emoteLibrary={};function handleMessage(e){"settings"===e.header?emoteFilter.initialize(e.payload.emoteFilterMode,e.payload.emoteFilterList):"emotes"===e.header?emoteLibrary=e.payload:"search"===e.header&&postMessage({header:"searchResults",payload:{searchID:e.payload.searchID,results:searchForEmotes(e.payload.text,!1===TWITCH_TV_MATCHING_REGEX.test(e.payload.hostname))}})}function searchForEmotes(e,a){var t,r=[];for(STRING_SEPARATOR.lastIndex=0;null!==(t=STRING_SEPARATOR.exec(e));){var o=t[0];for(var i in emoteLibrary)if(emoteLibrary.hasOwnProperty(i)){if(-1!==i.indexOf("twitchChannels")&&!1===a)continue;var s=emoteLibrary[i].emotes;if(s.hasOwnProperty(o)){var n=s[o];if(!0===emoteFilter.isEmoteAllowed(i,o)){r.push({index:t.index,emote:o,url:n.url,emoji:n.emoji,channel:n.channel});break}}}}return r}onmessage=function(e){handleMessage(e.data)};

},{"./emoteFilter":1}]},{},[2]);
